{% extends "base/index.html" %}
{% block content %}
<div class="container my-4">

    <div class="card shadow-sm">

        <!-- Header -->
        <div class="card-header bg-primary text-white">
            <h2 class="mb-0">{{ student.full_name }}</h2>
        </div>

        <div class="card-body">

            <div class="row">

                <!-- Photo -->
                <div class="col-md-4 text-center mb-3">
                    {% if student.photo %}
                        <img src="{{ student.photo.url }}" class="img-fluid rounded shadow-sm" alt="Photo">
                    {% else %}
                        <img
                             class="img-fluid rounded shadow-sm" alt="No Photo">
                    {% endif %}
                </div>

                <!-- Info -->
                <div class="col-md-8">

                    <h4 class="mb-3 fw-bold">Personal Information</h4>

                    <table class="table table-bordered">
                        <tbody>
                        <tr>
                            <th class="bg-light">Full Name</th>
                            <td>{{ student.full_name }}</td>
                        </tr>

                        <tr>
                            <th class="bg-light">Age</th>
                            <td>{{ student.age }} years</td>
                        </tr>

                        <tr>
                            <th class="bg-light">Date of Birth</th>
                            <td>{{ student.date_of_birth }}</td>
                        </tr>

                        <tr>
                            <th class="bg-light">Blood Group</th>
                            <td>{{ student.get_blood_group_display|default:"Not provided" }}</td>
                        </tr>

                        <tr>
                            <th class="bg-light">Nationality</th>
                            <td>{{ student.nationality }}</td>
                        </tr>

                        <tr>
                            <th class="bg-light">Student ID</th>
                            <td>{{ student.student_id }}</td>
                        </tr>

                        <tr>
                            <th class="bg-light">Roll Number</th>
                            <td>{{ student.roll_number }}</td>
                        </tr>
                        </tbody>
                    </table>

                    <h4 class="mt-4 mb-3 fw-bold">Contact Information</h4>

                    <table class="table table-bordered">
                        <tbody>
                        <tr>
                            <th class="bg-light">Phone</th>
                            <td>{{ student.phone_number|default:"Not provided" }}</td>
                        </tr>

                        <tr>
                            <th class="bg-light">Email</th>
                            <td>{{ student.email|default:"Not provided" }}</td>
                        </tr>
                        </tbody>
                    </table>

                    <h4 class="mt-4 mb-3 fw-bold">Parents Information</h4>

                    <table class="table table-bordered">
                        <tbody>
                        <tr>
                            <th class="bg-light">Father's Name</th>
                            <td>{{ student.fathers_name }}</td>
                        </tr>

                        <tr>
                            <th class="bg-light">Father's NID</th>
                            <td>{{ student.fathers_nid }}</td>
                        </tr>

                        <tr>
                            <th class="bg-light">Mother's Name</th>
                            <td>{{ student.mothers_name }}</td>
                        </tr>

                        <tr>
                            <th class="bg-light">Mother's NID</th>
                            <td>{{ student.mothers_nid }}</td>
                        </tr>
                        </tbody>
                    </table>

                </div>
            </div>

            <!-- Enrollment -->
            <hr>
            <h4 class="fw-bold">Enrollment History</h4>

            {% if student.enrollments.all %}
                <table class="table table-striped table-bordered mt-3">
                    <thead class="table-dark">
                        <tr>
                            <th>Class</th>
                            <th>Academic Year</th>
                            <th>Status</th>
                            <th>Enrollment Date</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for e in student.enrollments.all %}
                        <tr>
                            <td>{{ e.class_enrolled }}</td>
                            <td>{{ e.academic_year }}</td>
                            <td>{{ e.get_status_display }}</td>
                            <td>{{ e.enrollment_date }}</td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p>No enrollment history available.</p>
            {% endif %}

            <!-- Grades -->
            <hr>
            <h4 class="fw-bold">Grades</h4>

            {% if student.grades.all %}
                <table class="table table-bordered table-striped mt-3">
                    <thead class="table-secondary">
                        <tr>
                            <th>Exam</th>
                            <th>Subject</th>
                            <th>Marks</th>
                            <th>Percentage</th>
                            <th>Grade</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for g in student.grades.all %}
                        <tr>
                            <td>{{ g.exam.exam_name }}</td>
                            <td>{{ g.exam.subject.subject_name }}</td>
                            <td>
                                {% if g.is_absent %}
                                    Absent
                                {% else %}
                                    {{ g.marks_obtained }}/{{ g.exam.total_marks }}
                                {% endif %}
                            </td>
                            <td>{{ g.percentage|floatformat:2 }}%</td>
                            <td>{{ g.grade }}</td>
                            <td>
                                {% if g.is_passed %}
                                    <span class="badge bg-success">Passed</span>
                                {% else %}
                                    <span class="badge bg-danger">Failed</span>
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p>No grades available.</p>
            {% endif %}

        </div>

    </div>
</div>

{% endblock %}